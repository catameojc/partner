<% content_for :banner_title do %>
<%= fa_icon 'gears lg' %>&nbsp;Domains
<% end %>

<section>
  <div id="MyDomains">
    <div class="pull-right">
      <span class="text-danger"></span>
    </div>
    <div class="info-header">
      <h3>
        <%= link_to domains_path, :class => 'btn btn-default btn-xs back-btn' do %>
          <i class="fa fa-chevron-left"></i>
        <% end %> <%= @domain.name %>
      </h3>
    </div>
    <div></div>
    <div id="dom-reg-date">Registration Date: <%= formatted_date @domain.registered_at %></div>
    <div id="dom-exp-date">Expiration Date: <%= formatted_date @domain.expires_at %></div>

    <br>
    <!--new-->
    <h4> Domain Information</h4>
    <div class="contact-info-wrapper">

      <div class="title">Registrant</div>
      <div class="contact-info"><%= render partial: 'domains/domain_contact', locals: { contact: @domain.registrant } %></div>
      <div class="button">
        <%= link_to 'Edit', contact_path(@domain.registrant.handle, d: @domain.id), id: 'edit_registrant', :class => 'btn btn-primary btn-small' %>
      </div>
    </div>

    <% if @domain.admin_handle %>
    <div class="contact-info-wrapper">
      <div class="title">Administrative</div>
      <div class="contact-info"><%= render partial: 'domains/domain_contact', locals: { contact: @domain.admin_contact } %></div>
      <div class="button">
        <% if current_user.staff %>
          <%= link_to '', :class => 'btn btn-default' do %>   Edit
          <% end %>
        <% end %>
      </div>
    </div>
    <% end %>

    <% if @domain.billing_handle %>
    <div class="contact-info-wrapper">
      <div class="title">Billing</div>
      <div class="contact-info"><%= render partial: 'domains/domain_contact', locals: { contact: @domain.billing_contact } %></div>
      <div class="button">
        <% if current_user.staff %>
          <%= link_to '', :class => 'btn btn-default' do %>   Edit
          <% end %>
        <% end %>
      </div>
    </div>
    <% end %>

    <% if @domain.tech_handle %>
    <div class="contact-info-wrapper">
      <div class="title">Technical</div>
      <div class="contact-info"><%= render partial: 'domains/domain_contact', locals: { contact: @domain.tech_contact } %></div>
      <div class="button">
        <% if current_user.staff %>
          <%= link_to '', :class => 'btn btn-default' do %>   Edit
          <% end %>
        <% end %>
      </div>
    </div>
    <% end %>

    <br>

    <div class="pull-right">
    <% if current_user.staff %>
      <%= fa_icon 'plus' %> <%= link_to 'Add Nameservers', domain_hosts_path(@domain.id), id: :add_domain_host %>
    <% end %>
    </div>

    <h4>Nameservers</h4>

    <% unless @domain.hosts.empty? %>
    <div class="contact-info-wrapper">
      <div class="title">Nameservers</div>
      <div class="contact-info">
        <ul id="domain_hosts">
          <% @domain.hosts.each do |domain_host| %>
          <li><%= domain_host.name %> <%= link_to 'Remove', domain_host_path(@domain.name, domain_host.name), method: :delete, 'data-confirm': 'Are you sure you want to remove this nameserver?' %></li>
          <% end %>
        </ul>
      </div>
    </div>

    <% else %>
    No Nameservers
    <% end %>

    <br>

    <div class="pull-right"><a class="btn-link"><i class="fa fa-list-ul"></i> View All</a></div>
    <h4>Domain Activity</h4>
    <div class="contact-info-wrapper">
      <div class="title">Activities</div>
      <div class="contact-info">
        <table>
          <thead>
            <tr>
              <th>Date</th>
              <th>Description</th>
            </tr>
          </thead>
          <tbody>
            <% @domain.activities.each do |activity| %>
            <tr>
              <td><%= formatted_timestamp activity.activity_at %></td>
              <td><%= activity_description(activity).html_safe %></td>
            </tr>
            <% end %>
          </tbody>
        </table>
      </div>
    </div>

  </div>
</section>


